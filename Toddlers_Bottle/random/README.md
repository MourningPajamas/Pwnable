## random

Once we connect we see we have a flag file, a random.c file and the random binary.

Taking a look at random.c, in particular this if statement

![if](/Toddlers_Bottle/random/Images/if.png)

We see that we need to provide a value that when xor'd with the random number generated by the rand function equals 0xdeadbeef.

At first this appears this may be impossible since we're dealing with a random number.

However, taking a look at the man page for the rand function, (using "man 3 rand" on linux) the rand function generates a pseudo-random integer based off the seed provided. In this case our rand function is not passed a seed value which defaults to a seed value of 1.

We can verify that our random number stays constant using ltrace.

![flag](/Toddlers_Bottle/random/Images/ltrace.png)

Now that we know what our random number is (0x6b8b4567) we just need an appropriate value to xor with it to get 0xdeadbeef. We can use the following equation where ^ is the xor operator

key ^ random = 0xdeadbeef

xor'ing random on both sides we get:

key ^ random ^ random = 0xdeadbeef ^ random

Since anything xor'd with itself is zero we get

key = 0xdeadbeef ^ random = 0xdeadbeef ^ 0x6b8b4567 = 3039230856

Passing this into the random program we get our flag:

![flag](/Toddlers_Bottle/random/Images/flag.png)
